
This repository contains code used for the thesis "A Hybrid Homomorphic Encryption approach for Federated Learning". 

This repository provides the code for creating a Python library that enables the use of the PASTA cipher.  It is based on the [Hybrid HE Framework](https://github.com/isec-tugraz/hybrid-HE-framework), developed by Dobraunig et al.  The core binding between Python and C++ is implemented in `binder.cpp`, which is compiled into a Python module named `exemplo`.  

It also provides the code necessary to create the RSA certicates used for the experimental evaluation with the file `z_test_TLS/generate_cert.sh`. Currently, it is set to create certificates for RSA keys with 3072 bits.


The code with the implementation of the HHE scheme in FL is available in https://drive.google.com/drive/folders/19miLI9eniVmRq4e0ME6NShVxHDH5l2AI?usp=sharing. Inside the drive folder, read the `ReadME` file for more information on the files available.

The files `communication_costBFV.py` and `communication_costPasta.py` contain the code used to gather the size of the HE ciphertext, generated by the server, at the end of the aggregation process.

## Compiling the Framework

The C++ framework used was developed and tested on Linux (and WSL2). It requires the following dependencies:  

- `git`  
- `gcc/g++` (or `clang/clang++`)  
- `cmake`  
- `autoconf`  
- `libtool`  

Install them with:


```bash
sudo apt install build-essential cmake autoconf libtool
```

## Build Instructions 

From the projectâ€™s root directory, run:

```bash
mkdir build
cd build
cmake ..
make -j4
```

After compilation:
- Each cipher will have its own executable in the `build/test` directory.
- The Python library for calling the C++ ciphers is also generated. In this case:
```bash
build/exemplo.cpython-311-x86_64-linux-gnu.so
```

## Changing the Python Module Name
The module is defined via `pybind11` in `CMakeLists.txt`. To change the module name from `exemplo` to something else, edit the block below:

```cpp
pybind11_add_module(exemplo binder.cpp)
target_link_libraries(exemplo PRIVATE ${Python3_LIBRARIES} keccak aes perf plainciphers sealciphers SEAL::seal tfheciphers)
target_include_directories(exemplo PRIVATE ciphers/common_Zp)
```

Replace every occurrence of `exemplo` with your desired module name. To note, this will change the file created in `build/` to `build/<module_name>.cpython-311-x86_64-linux-gnu.so`

